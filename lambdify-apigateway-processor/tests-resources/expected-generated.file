package lambdify.apigateway.apt;

import java.util.*;
import java.math.*;

@SuppressWarnings("unchecked")
@javax.annotation.Generated( "Generated by Lambdify" )
public class MyAnnotatedResourceRouter implements lambdify.apigateway.Router {

	/* The wrapped instance */
	private final lambdify.apigateway.apt.MyAnnotatedResource instance;

    public lambdify.apigateway.Router.Entry<lambdify.apigateway.Router.Route, lambdify.apigateway.Router.LambdaFunction>[] getRoutes() {
		return arrayOf(
								lambdify.apigateway.Methods.GET.and( "/api/users/:id" ).with( this::getUser1 )
				,				lambdify.apigateway.Methods.POST.and( "/api/users" ).withNoContent( this::saveUser2 )
				,				lambdify.apigateway.Methods.PATCH.and( "/api/users" ).with( this::saveUser3 )
				,				lambdify.apigateway.Methods.PUT.and( "/api/users" ).with( this::updateUser4 )
		);
	}

    @SafeVarargs
    private static <T> T[] arrayOf( T...ts ){
        return ts;
    }

	/**
	 * Constructor for:
	 * <pre><code>
	 *   new lambdify.apigateway.apt.MyAnnotatedResource( semaphore );
	 * </code></pre>
	 */
	public MyAnnotatedResourceRouter( java.util.concurrent.atomic.AtomicBoolean semaphore ){
	    this.instance = new lambdify.apigateway.apt.MyAnnotatedResource( semaphore );
	}

	lambdify.aws.events.apigateway.ProxyResponseEvent getUser1(
			lambdify.aws.events.apigateway.ProxyRequestEvent request ){
		try {
		return lambdify.apigateway.Responses.ok(this.instance.getUser(
							lambdify.apigateway.RequestParameterReader.getPathParam( request, "id", java.lang.Long.class )
			,				lambdify.apigateway.RequestParameterReader.getHeaderParam( request, "accept", java.lang.String.class )
			,				lambdify.apigateway.RequestParameterReader.getQueryParam( request, "page", java.lang.String.class )
			,				request
		), "");
		} catch ( Throwable cause ) {
			throw new lambdify.apigateway.UnhandledException( cause );
		}
	}

	void saveUser2(
			lambdify.aws.events.apigateway.ProxyRequestEvent request ){
		try {
		this.instance.saveUser(
							lambdify.apigateway.apt.Account.produceAccount( request )
			,				lambdify.apigateway.RequestParameterReader.getBodyAs( request, lambdify.apigateway.apt.User.class )
		);
		} catch ( Throwable cause ) {
			throw new lambdify.apigateway.UnhandledException( cause );
		}
	}

	lambdify.aws.events.apigateway.ProxyResponseEvent saveUser3(
			lambdify.aws.events.apigateway.ProxyRequestEvent request ){
		try {
		return lambdify.apigateway.Responses.ok(this.instance.saveUser(
							lambdify.apigateway.RequestParameterReader.getBodyAs( request, java.util.Map.class )
		), "application/json");
		} catch ( Throwable cause ) {
			throw new lambdify.apigateway.UnhandledException( cause );
		}
	}

	lambdify.aws.events.apigateway.ProxyResponseEvent updateUser4(
			lambdify.aws.events.apigateway.ProxyRequestEvent request ){
		try {
		return this.instance.updateUser(
							lambdify.apigateway.RequestParameterReader.getQueryParam( request, "id", java.lang.Long.class )
			,				lambdify.apigateway.RequestParameterReader.getBodyAs( request, lambdify.apigateway.apt.User.class )
		);
		} catch ( Throwable cause ) {
			throw new lambdify.apigateway.UnhandledException( cause );
		}
	}

}
